# 线程和进程的区别

**概述**

​	进程和线程都是一个时间段的描述，是CPU工作时间段的描述

**背景**

​	CPU＋RAM＋各种资源（键盘，显示器等）构成我们的电脑，但是电脑的运行，实际就是CPU和相关寄存器及RAM之间的事情

**基础事实**

​	CPU执行效率非常快，寄存器仅仅能够跟上CPU的执行速度，RAM和其他挂靠在总线上的设备完全是望其项背。那当个任务需要执行的时候怎么办，轮流着来？谁有限度高谁先执行？不管什么样的策略，在CPU看来都是轮流着来。

**重要事实**

​	执行一段程序代码，实现一个功能的过程，当得到CPU的时候，相关的资源必须已经就位，就是显卡啊，GPS啊什么的必须已经就位，然后CPU开始执行。这里除了CPU以外所有的构成了这个程序的执行环境，也就是我们所定义的程序上下文。当这个程序执行完了，或者分配给它的CPU执行时间用完了，那它就要被切换出去，等待下一次的CPU临幸。在被切换出去的最后一步工作就是保存程序上下文，因为这是它被下一次的CPU临幸的工作环境，必须保存。

**事实总结**

​	在CPU看来所有的任务都是一个一个轮流执行的，具体的执行过程是：加载程序A的上下文，然后开始执行A，保存A程序的上下文，加载程序B的上下文，然后开始执行B，保存B程序的上下文。。。

**进程**

​	进程就是包括上下文切换的程序执行时间总和＝CPU加载上下文＋CPU执行程序＋CPU保存上下文

**线程**

​	进程的颗粒度太大，每次都要有上下文的调入，保存，调出。如果把进程比做电脑上的一个程序，那么一个软件的执行不可能是一条逻辑执行的，必定有多个分支和逻辑，就好比要执行进程A，实际分为a，b，c等多个块组合而成，那么具体执行的过程就可能变成：

​	程序A得到CPU＝》CPU加载上下文＝》开始执行程序的a小段＝》开始执行程序的b小段＝》开始执行程序的c小段＝》CPU保存上下文

这里的a，b，c实际执行的时候，共享了A的上下文，CPU在执行a，b，c的时候没有切换上下文，a，b，c就是线程，也就是说==线程共享了进程的上下文，是比进程粒度更细的的CPU时间段==。